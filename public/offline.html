<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ALAVI - You are offline</title>
  <style>
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background-color: #f9fafb;
      color: #1f2937;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      margin: 0;
      padding: 20px;
      text-align: center;
    }
    
    .dark body {
      background-color: #18181b;
      color: #f9fafb;
    }
    
    .container {
      max-width: 600px;
      padding: 40px;
      background-color: white;
      border-radius: 16px;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    }
    
    .dark .container {
      background-color: #27272a;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.2);
    }
    
    h1 {
      font-size: 2rem;
      font-weight: 600;
      margin-bottom: 1rem;
      background: linear-gradient(to right, #3b82f6, #0ea5e9);
      -webkit-background-clip: text;
      color: transparent;
      background-clip: text;
    }
    
    h2 {
      font-size: 1.5rem;
      font-weight: 500;
      margin-top: 2rem;
      margin-bottom: 1rem;
      color: #374151;
    }
    
    .dark h2 {
      color: #e5e7eb;
    }
    
    p {
      font-size: 1.125rem;
      line-height: 1.7;
      margin-bottom: 1.5rem;
      color: #4b5563;
    }
    
    .dark p {
      color: #d1d5db;
    }
    
    .button {
      display: inline-block;
      background: linear-gradient(to right, #3b82f6, #0ea5e9);
      color: white;
      padding: 0.75rem 1.5rem;
      border-radius: 9999px;
      font-weight: 500;
      text-decoration: none;
      transition: all 0.3s ease;
      border: none;
      cursor: pointer;
    }
    
    .button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
    }
    
    .icon {
      font-size: 4rem;
      margin-bottom: 1rem;
      color: #3b82f6;
    }
    
    .dark .icon {
      color: #60a5fa;
    }
    
    .tabs {
      display: flex;
      border-bottom: 1px solid #e5e7eb;
      margin-bottom: 1.5rem;
    }
    
    .dark .tabs {
      border-bottom-color: #374151;
    }
    
    .tab {
      padding: 0.75rem 1.5rem;
      cursor: pointer;
      border-bottom: 2px solid transparent;
      transition: all 0.2s ease;
    }
    
    .tab.active {
      border-bottom-color: #3b82f6;
      color: #3b82f6;
    }
    
    .dark .tab.active {
      color: #60a5fa;
      border-bottom-color: #60a5fa;
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
    }
    
    .cached-pages {
      text-align: left;
      padding-left: 1.5rem;
    }
    
    .cached-pages li {
      margin-bottom: 0.5rem;
    }
    
    .form-group {
      margin-bottom: 1.5rem;
      text-align: left;
    }
    
    label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
      color: #4b5563;
    }
    
    .dark label {
      color: #d1d5db;
    }
    
    input, textarea {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid #d1d5db;
      border-radius: 0.5rem;
      font-family: inherit;
      font-size: 1rem;
      background-color: white;
      color: #1f2937;
    }
    
    .dark input, .dark textarea {
      background-color: #374151;
      border-color: #4b5563;
      color: #f9fafb;
    }
    
    textarea {
      min-height: 100px;
      resize: vertical;
    }
    
    .offline-message {
      background-color: #fef3c7;
      color: #92400e;
      padding: 0.75rem;
      border-radius: 0.5rem;
      margin-top: 1rem;
      font-size: 0.875rem;
      display: flex;
      align-items: center;
    }
    
    .dark .offline-message {
      background-color: #78350f;
      color: #fef3c7;
    }
    
    .offline-message svg {
      margin-right: 0.5rem;
      flex-shrink: 0;
    }
    
    /* Check for dark mode preference */
    @media (prefers-color-scheme: dark) {
      html {
        color-scheme: dark;
      }
      html:not(.light) {
        color-scheme: dark;
      }
      html:not(.light) body {
        background-color: #18181b;
        color: #f9fafb;
      }
      html:not(.light) .container {
        background-color: #27272a;
      }
      html:not(.light) p {
        color: #d1d5db;
      }
      html:not(.light) .icon {
        color: #60a5fa;
      }
      html:not(.light) h2 {
        color: #e5e7eb;
      }
      html:not(.light) .tabs {
        border-bottom-color: #374151;
      }
      html:not(.light) .tab.active {
        color: #60a5fa;
        border-bottom-color: #60a5fa;
      }
      html:not(.light) label {
        color: #d1d5db;
      }
      html:not(.light) input, html:not(.light) textarea {
        background-color: #374151;
        border-color: #4b5563;
        color: #f9fafb;
      }
      html:not(.light) .offline-message {
        background-color: #78350f;
        color: #fef3c7;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="icon">ðŸ“¶</div>
    <h1>You're Offline</h1>
    <p>It looks like you've lost your internet connection. Some features may be limited until you're back online.</p>
    
    <div class="tabs">
      <div class="tab active" onclick="showTab('info')">Information</div>
      <div class="tab" onclick="showTab('contact')">Contact Us</div>
    </div>
    
    <div id="info" class="tab-content active">
      <p>We've saved the following pages so you can still access them while offline:</p>
      <ul class="cached-pages">
        <li><a href="/">Home Page</a></li>
        <li><a href="/about">About Us</a></li>
        <li><a href="/services">Our Services</a></li>
        <li><a href="/work">Our Work</a></li>
      </ul>
      
      <h2>What's Available Offline?</h2>
      <p>You can still browse our main website pages and view critical content. Images and some dynamic content may not be available until you're back online.</p>
      
      <p>Once you reconnect, any forms you submit while offline will automatically be sent.</p>
      
      <button class="button" onclick="window.location.reload()">Try Again</button>
    </div>
    
    <div id="contact" class="tab-content">
      <h2>Send us a message</h2>
      <p>Fill out this form and it will be sent automatically when you're back online.</p>
      
      <form id="offline-contact-form">
        <div class="form-group">
          <label for="name">Your Name</label>
          <input type="text" id="name" name="name" required>
        </div>
        
        <div class="form-group">
          <label for="email">Email Address</label>
          <input type="email" id="email" name="email" required>
        </div>
        
        <div class="form-group">
          <label for="message">Message</label>
          <textarea id="message" name="message" required></textarea>
        </div>
        
        <button type="submit" class="button">Send Message</button>
        
        <div class="offline-message">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="8" x2="12" y2="12"></line>
            <line x1="12" y1="16" x2="12.01" y2="16"></line>
          </svg>
          Your message will be stored locally and sent when you're back online
        </div>
      </form>
    </div>
  </div>

  <script>
    // Check for dark mode preference
    function setThemeClass() {
      const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches;
      const storedTheme = localStorage.getItem('theme');
      
      if (storedTheme === 'dark' || (!storedTheme && isDarkMode)) {
        document.documentElement.classList.add('dark');
        document.documentElement.classList.remove('light');
      } else {
        document.documentElement.classList.add('light');
        document.documentElement.classList.remove('dark');
      }
    }
    
    // Set theme on load
    setThemeClass();
    
    // Listen for changes in system preference
    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', setThemeClass);
    
    // Tab functionality
    function showTab(tabId) {
      // Hide all tab contents
      document.querySelectorAll('.tab-content').forEach(content => {
        content.classList.remove('active');
      });
      
      // Deactivate all tabs
      document.querySelectorAll('.tab').forEach(tab => {
        tab.classList.remove('active');
      });
      
      // Activate the selected tab
      document.getElementById(tabId).classList.add('active');
      document.querySelector(`.tab[onclick="showTab('${tabId}')"]`).classList.add('active');
    }
    
    // Handle form submission
    document.getElementById('offline-contact-form').addEventListener('submit', function(event) {
      event.preventDefault();
      
      const formData = {
        name: document.getElementById('name').value,
        email: document.getElementById('email').value,
        message: document.getElementById('message').value,
        timestamp: new Date().toISOString()
      };
      
      // Store the form data for later sending
      saveOfflineForm(formData);
      
      // Show a success message
      alert('Your message has been saved and will be sent when you\'re back online');
      
      // Reset the form
      this.reset();
    });
    
    // Save form data to IndexedDB for later submission
    function saveOfflineForm(formData) {
      // Check if service worker and IndexedDB are available
      if ('serviceWorker' in navigator && 'IndexedDB' in window && navigator.serviceWorker.controller) {
        // Send the data to the service worker to store in IndexedDB
        navigator.serviceWorker.controller.postMessage({
          type: 'STORE_FORM',
          payload: {
            storeName: 'offline-forms',
            data: formData
          }
        });
      } else {
        // Fallback to localStorage if service worker or IndexedDB is not available
        saveFormToLocalStorage(formData);
      }
    }
    
    // Save form to localStorage as fallback
    function saveFormToLocalStorage(formData) {
      const offlineForms = JSON.parse(localStorage.getItem('offline-forms') || '[]');
      offlineForms.push(formData);
      localStorage.setItem('offline-forms', JSON.stringify(offlineForms));
      console.log('Form saved to localStorage');
    }
    
    // Listen for messages from the service worker
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.addEventListener('message', function(event) {
        const message = event.data;
        
        if (message && message.type === 'STORE_FORM_FALLBACK') {
          // Service worker couldn't store the form, save to localStorage instead
          saveFormToLocalStorage(message.payload.data);
        }
      });
    }
  </script>
</body>
</html>
